<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>{{ post.title }} â€” VibeCoder ë¼ìš´ì§€</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet"/>
  <style>
    :root{--bg:#050508;--surface:#0d0d14;--surface2:#13131e;--border:rgba(255,255,255,.07);
      --accent:#7c3aed;--accent2:#06b6d4;--text:#f1f5f9;--muted:#64748b;--radius:14px;}
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
    body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;}
    .bg-orbs{position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden;}
    .orb{position:absolute;border-radius:50%;filter:blur(120px);opacity:.05;animation:orbFloat 22s ease-in-out infinite;}
    .orb:nth-child(1){width:450px;height:450px;background:radial-gradient(circle,#06b6d4,transparent);top:-100px;right:5%;}
    @keyframes orbFloat{0%,100%{transform:translate(0,0);}50%{transform:translate(30px,-40px);}}
    .content{position:relative;z-index:1;}

    header{position:sticky;top:0;z-index:100;background:rgba(5,5,8,.85);backdrop-filter:blur(20px);border-bottom:1px solid var(--border);}
    nav{max-width:1200px;margin:0 auto;display:flex;align-items:center;gap:8px;height:64px;padding:0 24px;}
    .logo{font-size:1.4rem;font-weight:800;background:linear-gradient(135deg,#7c3aed,#06b6d4);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-decoration:none;margin-right:auto;}
    nav a{color:var(--muted);text-decoration:none;font-size:.9rem;padding:8px 14px;border-radius:8px;transition:all .2s;}
    nav a:hover{color:var(--text);background:rgba(255,255,255,.05);}

    main{max-width:760px;margin:0 auto;padding:60px 24px;}
    .back-link{display:inline-flex;align-items:center;gap:6px;color:var(--muted);text-decoration:none;font-size:.88rem;margin-bottom:32px;transition:color .2s;}
    .back-link:hover{color:var(--text);}

    /* í¬ìŠ¤íŠ¸ ì¹´ë“œ */
    .post-card{background:linear-gradient(145deg,var(--surface),var(--surface2));border:1px solid var(--border);border-radius:20px;padding:40px;margin-bottom:28px;}
    .post-meta-top{display:flex;align-items:center;gap:12px;margin-bottom:24px;flex-wrap:wrap;}
    .cat-badge{padding:4px 12px;border-radius:6px;font-size:.75rem;font-weight:700;}
    .cat-tip{background:rgba(245,158,11,.12);color:#fbbf24;border:1px solid rgba(245,158,11,.2);}
    .cat-qna{background:rgba(6,182,212,.12);color:#22d3ee;border:1px solid rgba(6,182,212,.2);}
    .cat-showcase{background:rgba(124,58,237,.12);color:#a78bfa;border:1px solid rgba(124,58,237,.2);}
    .cat-free{background:rgba(255,255,255,.05);color:var(--muted);border:1px solid var(--border);}
    .author-name{font-size:.9rem;font-weight:600;}
    .post-time{font-size:.82rem;color:var(--muted);}
    .post-stats-top{margin-left:auto;display:flex;gap:12px;font-size:.82rem;color:var(--muted);}

    h1.post-title{font-size:1.8rem;font-weight:800;line-height:1.3;margin-bottom:24px;letter-spacing:-.02em;}
    .post-body{font-size:.98rem;line-height:1.85;color:#cbd5e1;white-space:pre-wrap;word-break:break-word;}
    .post-body a{color:#22d3ee;text-decoration:underline;}

    .post-tags{display:flex;flex-wrap:wrap;gap:6px;margin-top:24px;}
    .tag{background:rgba(124,58,237,.1);color:#a78bfa;border:1px solid rgba(124,58,237,.15);font-size:.75rem;padding:3px 10px;border-radius:100px;}

    .post-actions{display:flex;align-items:center;gap:12px;margin-top:28px;padding-top:24px;border-top:1px solid var(--border);}
    .like-btn{display:flex;align-items:center;gap:8px;padding:10px 20px;border-radius:10px;
      border:1px solid var(--border);background:transparent;color:var(--muted);
      font-size:.9rem;cursor:pointer;transition:all .2s;font-family:'Inter',sans-serif;}
    .like-btn:hover,.like-btn.liked{border-color:rgba(239,68,68,.35);color:#f87171;background:rgba(239,68,68,.06);}
    .share-btn{padding:10px 20px;border-radius:10px;border:1px solid var(--border);
      background:transparent;color:var(--muted);font-size:.9rem;cursor:pointer;transition:all .2s;font-family:'Inter',sans-serif;}
    .share-btn:hover{border-color:rgba(6,182,212,.3);color:#22d3ee;}
    .delete-form{margin-left:auto;}
    .delete-btn{padding:8px 16px;border-radius:8px;border:1px solid rgba(248,113,113,.2);
      background:transparent;color:#f87171;font-size:.82rem;cursor:pointer;transition:all .2s;font-family:'Inter',sans-serif;}
    .delete-btn:hover{background:rgba(248,113,113,.08);}

    /* ìŠ¤íŒ¸ ê²½ê³  */
    .spam-warn{background:rgba(234,179,8,.08);border:1px solid rgba(234,179,8,.2);
      border-radius:10px;padding:12px 16px;margin-bottom:20px;color:#fde047;font-size:.85rem;}

    /* ëŒ“ê¸€ */
    .comments-section{margin-top:8px;}
    .comments-title{font-size:1.1rem;font-weight:700;margin-bottom:20px;}
    .comment-item{background:var(--surface);border:1px solid var(--border);border-radius:12px;
      padding:18px 20px;margin-bottom:10px;position:relative;}
    .comment-meta{display:flex;align-items:center;gap:12px;margin-bottom:10px;}
    .comment-author{font-size:.85rem;font-weight:600;}
    .comment-time{font-size:.78rem;color:var(--muted);}
    .comment-body{font-size:.9rem;line-height:1.7;color:#cbd5e1;white-space:pre-wrap;}
    .comment-del-btn{position:absolute;top:12px;right:12px;padding:4px 10px;border-radius:6px;
      border:1px solid transparent;background:transparent;color:var(--muted);font-size:.75rem;
      cursor:pointer;transition:all .2s;font-family:'Inter',sans-serif;}
    .comment-del-btn:hover{border-color:rgba(248,113,113,.2);color:#f87171;}

    /* ëŒ“ê¸€ ì‘ì„± í¼ */
    .comment-form{background:linear-gradient(145deg,var(--surface),var(--surface2));
      border:1px solid var(--border);border-radius:16px;padding:28px;margin-top:24px;}
    .comment-form h3{font-size:1rem;font-weight:700;margin-bottom:20px;}
    .form-row2{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:12px;}
    .cf-input{width:100%;background:#050508;border:1px solid rgba(255,255,255,.08);
      color:var(--text);padding:10px 14px;border-radius:9px;font-size:.88rem;
      font-family:'Inter',sans-serif;outline:none;transition:border .2s;}
    .cf-input:focus{border-color:rgba(6,182,212,.35);}
    .cf-textarea{width:100%;background:#050508;border:1px solid rgba(255,255,255,.08);
      color:var(--text);padding:12px 14px;border-radius:9px;font-size:.88rem;
      font-family:'Inter',sans-serif;outline:none;resize:vertical;min-height:100px;line-height:1.6;transition:border .2s;}
    .cf-textarea:focus{border-color:rgba(6,182,212,.35);}
    ::placeholder{color:var(--muted);}
    .cf-submit{background:linear-gradient(135deg,#06b6d4,#0891b2);color:#fff;border:none;
      padding:11px 28px;border-radius:9px;font-size:.9rem;font-weight:700;cursor:pointer;
      font-family:'Inter',sans-serif;margin-top:12px;transition:all .2s;
      box-shadow:0 2px 12px rgba(6,182,212,.25);}
    .cf-submit:hover{box-shadow:0 4px 20px rgba(6,182,212,.4);transform:translateY(-1px);}

    .empty-comments{text-align:center;padding:32px;color:var(--muted);font-size:.9rem;}

    footer{border-top:1px solid var(--border);padding:32px 24px;text-align:center;color:var(--muted);font-size:.85rem;margin-top:40px;}

    @media(max-width:640px){
      nav a:not(.logo){display:none;}
      main{padding:40px 16px;}
      .post-card{padding:24px;}
      h1.post-title{font-size:1.4rem;}
      .form-row2{grid-template-columns:1fr;}
    }
  </style>
</head>
<body>
<div class="bg-orbs"><div class="orb"></div></div>
<div class="content">

<header>
  <nav>
    <a href="/" class="logo">âš¡ VibeCoder</a>
    <a href="/showcase">ì‡¼ì¼€ì´ìŠ¤</a>
    <a href="/lounge">ë¼ìš´ì§€</a>
    <a href="/submit">í”„ë¡œì íŠ¸ ì˜¬ë¦¬ê¸°</a>
  </nav>
</header>

<main>
  <a href="/lounge" class="back-link">â† ë¼ìš´ì§€ë¡œ ëŒì•„ê°€ê¸°</a>

  {% if post.is_spam %}
  <div class="spam-warn">âš ï¸ ì´ ê¸€ì€ ìŠ¤íŒ¸ìœ¼ë¡œ ë¶„ë¥˜ë˜ì–´ ê²€í†  ì¤‘ì…ë‹ˆë‹¤.</div>
  {% endif %}

  <div class="post-card">
    <div class="post-meta-top">
      <span class="cat-badge cat-{{ post.category or 'free' }}">
        {{ {'tip':'ğŸ’¡ ê¿€íŒ','qna':'â“ Q&A','showcase':'ğŸ¨ ì‡¼ì¼€ì´ìŠ¤','free':'ğŸ’¬ ììœ '}.get(post.category, post.category) }}
      </span>
      <span class="author-name">{{ post.author_name or 'ìµëª…ì½”ë”' }}</span>
      <span class="post-time">{{ post.created_at | fmt_date }}</span>
      <div class="post-stats-top">
        <span>ğŸ‘ {{ post.view_count }}</span>
        <span>â¤ï¸ <span id="like-count">{{ post.likes }}</span></span>
      </div>
    </div>

    <h1 class="post-title">{{ post.title }}</h1>

    <div class="post-body">{{ post.content }}</div>

    {% if post.tags %}
    <div class="post-tags">
      {% for tag in post.tags.split(',') %}
      <span class="tag">#{{ tag.strip() }}</span>
      {% endfor %}
    </div>
    {% endif %}

    <div class="post-actions">
      <button class="like-btn" id="like-btn" onclick="likePost()">
        â¤ï¸ ì¢‹ì•„ìš” <span id="like-btn-count">{{ post.likes }}</span>
      </button>
      <button class="share-btn" onclick="sharePost()">ğŸ”— ê³µìœ </button>

      {% if can_edit %}
      <div class="delete-form" style="margin-left:auto">
        <form method="POST" action="/lounge/{{ post.slug }}/delete" onsubmit="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">
          <button type="submit" class="delete-btn">ğŸ—‘ï¸ ì‚­ì œ</button>
        </form>
      </div>
      {% endif %}
    </div>
  </div>

  <!-- ëŒ“ê¸€ ëª©ë¡ -->
  <div class="comments-section">
    <h2 class="comments-title">ğŸ’¬ ëŒ“ê¸€ {{ comments|length }}ê°œ</h2>

    {% if comments %}
    {% for comment in comments %}
    <div class="comment-item">
      <div class="comment-meta">
        <span class="comment-author">{{ comment.author_name or 'ìµëª…ì½”ë”' }}</span>
        <span class="comment-time">{{ comment.created_at | fmt_date }}</span>
      </div>
      <div class="comment-body">{{ comment.content }}</div>

      {% if session_token and session_token == comment.session_token %}
      <form method="POST" action="/comment/{{ comment.id }}/delete" style="display:inline"
            onsubmit="return confirm('ëŒ“ê¸€ì„ ì‚­ì œí• ê¹Œìš”?')">
        <input type="hidden" name="redirect_url" value="/lounge/{{ post.slug }}"/>
        <button type="submit" class="comment-del-btn">ì‚­ì œ</button>
      </form>
      {% endif %}
    </div>
    {% endfor %}
    {% else %}
    <div class="empty-comments">ì²« ëŒ“ê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”! ğŸ‘‹</div>
    {% endif %}

    <!-- ëŒ“ê¸€ ì‘ì„± -->
    <div class="comment-form">
      <h3>ëŒ“ê¸€ ë‹¬ê¸°</h3>
      <form method="POST" action="/comment">
        <input type="hidden" name="post_id" value="{{ post.id }}"/>
        <input type="hidden" name="redirect_url" value="/lounge/{{ post.slug }}"/>
        <div class="form-row2">
          <input class="cf-input" type="text" name="author" placeholder="ë‹‰ë„¤ì„ (ì„ íƒ)" maxlength="30"/>
          <input class="cf-input" type="password" name="password" placeholder="ë¹„ë°€ë²ˆí˜¸ (ì‚­ì œìš©, ì„ íƒ)"/>
        </div>
        <textarea class="cf-textarea" name="content" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•´ì£¼ì„¸ìš”..." required></textarea>
        <button type="submit" class="cf-submit">ëŒ“ê¸€ ë“±ë¡</button>
      </form>
    </div>
  </div>
</main>

<footer>Â© 2025 VibeCoder</footer>
</div>

<script>
function likePost(){
  fetch('/lounge/{{ post.slug }}/like',{method:'POST'})
    .then(r=>r.json()).then(d=>{
      document.getElementById('like-count').textContent=d.likes;
      document.getElementById('like-btn-count').textContent=d.likes;
      document.getElementById('like-btn').classList.add('liked');
    });
}
function sharePost(){
  navigator.clipboard.writeText(location.href).then(()=>{
    const btn=document.querySelector('.share-btn');
    btn.textContent='âœ… ë³µì‚¬ë¨!';
    setTimeout(()=>btn.textContent='ğŸ”— ê³µìœ ',2000);
  });
}
</script>
</body>
</html>
